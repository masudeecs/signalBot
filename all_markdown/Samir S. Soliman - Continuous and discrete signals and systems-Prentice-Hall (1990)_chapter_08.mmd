## Chapter 8 The \(Z\)-Transform

In this chapter, we study the \(Z\)-transform, which is the discrete-time counterpart of the Laplace transform that we studied in Chapter 5. Just as the Laplace transform can be considered to be an extension of the Fourier transform, the \(Z\)-transform can be considered to be an extension of the discrete-time Fourier transform. As can be expected, the properties of the \(Z\)-transform closely resemble those of the Laplace transform, so that the results of this chapter are similar to those of Chapter 5. However, as with the discrete-time Fourier transform, there are also some major differences.

We have, in essence, already encountered the \(Z\)-transform in Section 7.1, where we discussed the response of a linear discrete-time time-invariant system to exponential inputs. There we saw that if the input to the system was \(x\left(n\right)=z^{n}\), the output was given by

\[y\left(n\right)=H\left(z\right)z^{n} \tag{8.1.1}\]

where \(H\left(z\right)\) was defined in terms of the impulse response \(h\left(n\right)\) of the system as

\[H\left(z\right)=\sum_{n\text{ }=-\infty}^{\infty}h\left(n\right)z^{-n} \tag{8.1.2}\]

Equation (8.1.2), essentially defines the \(Z\)-transform of sequence \(h\left(n\right)\). We formalize this definition in the next section and subsequently investigate the properties and look at the applications of the \(Z\)-transform.

Consider a sequence \(x\,(n)\), with the \(Z\)-transform

\[X(z)=\sum_{n\,=\,-\,\infty}^{\infty}x(n)\,z^{-n}\,. \tag{8.3.1}\]

We want to determine the values of \(z\) for which \(X(z)\) exists. In order to do so, we represent \(z\) in polar form as \(z=r\exp\left[\,j\theta\right]\), and write

\[X(z) =\sum_{n\,=\,-\,\infty}^{\infty}x(n)(r\,\,\exp\left[\,j\theta \right])^{-n}\] \[=\sum_{n\,=\,-\,\infty}^{\infty\,\infty}x(n)\,r^{-n}\,\exp\left[ \,-jn\theta\right] \tag{8.3.2}\]

Let \(x_{+}(n)\) and \(x_{-}(n)\) denote the causal and anticausal parts of \(x\,(n)\), respectively. That is,

\[x(n)=\begin{cases}x_{+}(n),&n\geq 0\\ x_{-}(n),&n<0\end{cases}. \tag{8.3.3}\]

We substitute Equation (8.3.3) into Equation (8.3.2) to get

\[X(z) =\sum_{n\,=\,-\,\infty}^{-1}x_{-}(n)\,\,r^{-n}\,\exp\left[\,-jn \theta\right]+\sum_{n\,=\,0}^{\infty}x_{+}(n)\,\,r^{-n}\,\exp\left[\,-jn\theta\right]\] \[=\sum_{m\,=\,1}^{\infty}x_{-}(-m)\,\,r^{m}\,\exp\left[\,jm\theta \right]+\sum_{n\,=\,0}^{\infty}x_{+}(n)\,\,r^{-n}\,\exp\left[\,-jn\theta\right]\] \[\leq\sum_{m\,=\,1}^{\infty}\left|\,x_{-}(-m)\,\,\right|\,r^{m} +\sum_{n\,=\,0}^{\infty\,\infty}\left|\,x_{+}(n)\,\right|\,r^{-n} \tag{8.3.4}\]

Figure 8.2.1: Regions of convergence of the \(Z\)-transforms for Example 8.2.3 (a) ROC for \(X(z)\) (b) ROC for \(Y(z)\).

For \(X(z)\) to exist, each of the two terms on the right-hand side of Equation (8.3.4) must be finite. Suppose there exist constants \(M,\ N,\ R_{-}\), and \(R_{+}\) such that

\[\left|x_{-}(n)\right|\ <MR_{-}^{n}\qquad\text{for $n<0$},\qquad\left|x_{+}(n) \right|\ <NR_{+}^{n}\qquad\text{for $n\geq 0$} \tag{8.3.5}\]

We can substitute these bounds in Equation (8.3.4) to obtain

\[X(z)\leq M\ \sum_{m=1}^{\infty}R_{-}^{-m}\ r^{m}+N\ \sum_{n=0}^{\infty}R_{+}^{n}\ r ^{-n} \tag{8.3.6}\]

Clearly, the first sum in Equation (8.3.6) is finite if \(r/R_{-}<1\), and the second sum is finite if \(R_{+}/r<1\). We can combine the two relations to determine the region of convergence for \(X(z)\) as

\[R_{+}<r<R_{-}\]

Figure 8.3.1 shows the region of convergence in the \(z\) plane as the annular region between the circles of radii \(R_{-}\) and \(R_{+}\). The part of the transform corresponding to the causal sequence \(x_{+}(n)\) converges in the region for which \(r>R_{+}\) or, equivalently, \(\left|z\right|\ >R_{+}\). That is, the region of convergence is outside the circle with radius \(R_{+}\). Similarly, the transform corresponding to the anticausal sequence \(x_{-}(n)\) converges for \(r<R_{-}\) or, equivalently, for \(\left|z\right|\ <R_{-}\), so that the region of convergence is inside the circle of radius \(R_{-}\). X(z) does not exist if \(R_{-}<R_{+}\).

We recall from our discussion of the Fourier transform of discrete-time signals in Chapter 7 that frequency variable \(\Omega\) takes on values in \([0,\ 2\pi]\). For a fixed value of \(r\), it follows from a comparison of Equation (8.3.2) with Equation (7.3.2) that \(X(z)\) can be interpreted as the discrete-time Fourier transform of signal \(x\left(n\right)r^{-n}\). This corresponds to evaluating \(X(z)\) along the circle of radius \(\Omega\) in the \(z\) plane. If we set \(r=1\), that is, for values of \(z\) along the circle with unity radius, \(X\left(z\right)\) reduces to the discrete-time Fourier transform of \(x\left(n\right)\), assuming that it exists. The circle with radius unity is referred to as the unit circle.

Figure 8.3.1: Region of convergence for a general noncausal sequence.

In general, if \(x\left(n\right)\) is the sum of several sequences, \(X\left(z\right)\) exists only if there is a set of values of \(z\) for which the transforms of each of the sequences forming the sum converge. The region of convergence is thus the intersection of the individual regions of convergence. If there is no common region of convergence, then \(X\left(z\right)\) does not exist.

**Example 8.3.1**: Consider the function

\[x\left(n\right)=\left(\frac{1}{3}\right)^{n}\,u\left(n\right)\]

Clearly, \(R_{+}=\frac{1}{3}\) and \(R_{-}=\infty\), so that the region of convergence is

\[\mid z\mid\,>\,\frac{1}{3}\]

The \(Z\)-transform of \(x\left(n\right)\) is given by

\[X\left(z\right)=\frac{1}{1-\frac{1}{3}\,\,z^{-1}}=\frac{z}{z-\frac{1}{3}}\]

which has a pole at \(z=1/3\). The region of convergence is thus outside the circle enclosing the pole of \(X\left(z\right)\). Now let us consider the function

\[x\left(n\right)=\left(\frac{1}{2}\right)^{n}\,u\left(n\right)+\left(\frac{1} {3}\right)^{n}\,u\left(n\right)\]

which is the sum of the two functions

\[x_{1}\left(n\right)=\left(\frac{1}{2}\right)^{n}\,u\left(n\right)\,\text{ and }\,\,x_{2}\left(n\right)=\left(\frac{1}{3}\right)^{n}\,u\left(n\right)\]

From the preceding example, the region of convergence for \(X_{1}\left(z\right)\) is

\[\mid z\mid\,>\,\frac{1}{2}\]

whereas, for \(X_{2}\left(z\right)\) it is

\[\mid z\mid\,>\,\frac{1}{3}\]

Thus the region of convergence for \(X\left(z\right)\) is the intersection of these two regions and is given by

\[\mid z\mid\,>\,\text{Max}\left(\frac{1}{2}\,\,,\,\frac{1}{3}\right)=\frac{1}{2}\]

It can easily be verified that \(X\left(z\right)\) is given by

\[X\left(z\right)=\frac{z}{z-\frac{1}{2}}+\frac{z}{z-\frac{1}{3}}=\frac{2z^{2}- \frac{5}{6}\,z}{(z-\frac{1}{2})(z-\frac{1}{3})}\]

Thus the region of convergence is outside the circle which includes both poles of \(X\left(z\right)\).

The example above shows that for a causal sequence, the region of convergence is 

In the rest of this chapter, we restrict ourselves to causal signals and systems. As such, we are concerned only with the unilateral transform. In the next section, we discuss some of the relevant properties of the unilateral \(Z\)-transform. We note, however, that many of these properties carry over to the bilateral transform.

### \(Z\)-Transform Properties

We recall the definition of the \(Z\)-transform of a causal sequence \(x\left(n\right)\) as

\[X\left(z\right)=\sum_{n\,=\,0}^{\infty}\,x\left(n\right)z^{-n} \tag{8.4.1}\]

We can directly use Equation (8.4.1) to derive the \(Z\)-transforms of common discrete-time signals, as the following example shows.

**Example 8.4.1**: (a) For the \(\delta\) function, we saw that the transform is given by

\[Z\left[\delta(n)\right]=1\,\cdot\,z^{0}=1\quad\quad. \tag{8.4.2}\]

(b) Let

\[x\left(n\right)=\alpha^{n}u\left(n\right)\]

Then

\[X\left(z\right)=\sum_{n\,=\,0}^{\infty}\,\alpha^{n}z^{-n}=\frac{1}{1-\alpha z ^{-1}}=\frac{z}{z\,-\alpha} \tag{8.4.3}\]

By letting \(\alpha=1\) in (b), we obtain the transform of the unit-step function as

\[Z\left[u\left(n\right)\right]=\frac{z}{z\,-1} \tag{8.4.4}\](c) Let

\[x\left(n\right)=\cos\ \Omega_{0}\ n \tag{8.4.5}\]

By writing \(x\left(n\right)\) as

\[x\left(n\right)=\frac{1}{2}\ \left[\ \exp\left[\,j\Omega_{0}n\,\right]+\exp\left[ \,-j\Omega_{0}n\,\right]\right]\]

and using the results in (b), it follows that \(X\left(z\right)\) is given by

\[X\left(z\right) =\frac{1}{2}\ \frac{z}{z-\exp\left[\,j\Omega_{0}\right]}+\frac{1}{2} \ \frac{z}{z-\exp\left[\,-j\Omega_{0}\right]}\] \[=\frac{z\left(z-\cos\ \Omega_{0}\right)}{z^{2}-2z\ \cos\ \Omega_{0}+1} \tag{8.4.6}\]

Similarly, the \(Z\)-transform of the sequence

\[x\left(n\right)=\sin\ \Omega_{0}\ n \tag{8.4.7}\]

is given by

\[X\left(z\right)=\frac{z\ \sin\ \Omega_{0}}{z^{2}-2z\ \cos\ \Omega_{0}+1} \tag{8.4.8}\]

Let \(x\left(n\right)\) be noncausal with \(x_{+}(n)\) and \(x_{-}(n)\) denoting its causal and anticausal parts, respectively, as in Equation (8.3.3). Then

\[X\left(z\right)=X_{+}\left(z\right)+X_{-}\left(z\right) \tag{8.4.9}\]

Now

\[X_{-}\left(z\right)=\sum_{n\ =-\infty}^{-1}x_{-}\left(n\right)\ z^{-n} \tag{8.4.10}\]

By making the change of variable \(m=-n\) and noting that \(x_{-}(0)=0\), we can write

\[X_{-}\left(z\right)=\sum_{m\ =\ 0}^{\infty}x_{-}\left(-m\right)\ z^{m} \tag{8.4.11}\]

Let us denote \(x_{-}(-m)\) by \(x_{1}(m)\). It then follows that

\[X_{-}\left(z\right)=X_{1}\left(z^{-1}\right) \tag{8.4.12}\]

where \(X_{1}\left(z\right)\) denotes the \(Z\)-transform of the _causal_ sequence \(x_{-}(-n)\)

**Example 8.4.2**: Let

\[x\left(n\right)=\left(\frac{1}{2}\right)^{1n\ 1}\]

Then

\[x_{+}(n)=\left(\frac{1}{2}\right)^{n},\qquad n\geq 0\]\[x_{-}(n)=(\frac{1}{2})^{-n},\qquad n<0\]

and

\[x_{1}(n) =x_{-}(-n)=(\frac{1}{2})^{n}\quad n>0\] \[=(\frac{1}{2})^{n}\ u(n)-\delta(n)\]

From Example 8.4.1, we can write

\[X_{+}(z)=\frac{z}{z-\frac{1}{2}}\,\qquad|z\ |\ >\frac{1}{2}\]

and

\[X_{1}(z)=\frac{z}{z-\frac{1}{2}}\ -\ 1=\frac{\frac{1}{2}}{z-\frac{1}{2}}\, \qquad|z\ |\ >\frac{1}{2}\]

so that

\[X_{-}(z)=-\ \frac{1}{z-2}\,\qquad|z\ |\ <2\]

and

\[X(z)=\frac{z}{z-\frac{1}{2}}-\frac{1}{z-2}\,\ \ \ \ \ \frac{1}{2}<\ |z\ |\ <2\]

Thus, a table of transforms of causal time functions can also be used to find the \(Z\)-transforms of noncausal functions. Table 8.1 lists the transform pairs derived in Example 8.3.1 as well as a few others. The additional pairs can be derived directly by using the definition of Equation (8.4.1) or by using the properties of the \(Z\)-transform. We discuss a few of these properties in the next sections. Since these properties are similar to those of the other transforms we have discussed so far, we state many of the more familiar properties and do not derive them in detail.

#### Linearity

If \(x_{1}(n)\) and \(x_{2}(n)\) are two sequences with transforms \(X_{1}(z)\) and \(X_{2}(z)\), respectively, then

\[Z\ [\ a_{1}\,x_{1}(n)+a_{2}\,x_{2}(n)]=a_{1}\,X_{1}(z)+a_{2}\,X_{2}(z) \tag{8.4.13}\]

where \(a_{1}\) and \(a_{2}\) are arbitrary constants.

#### Time Shifting

Let \(x(n)\) be a causal sequence and let \(X(z)\) denote its transform. Then, for any integer \(n_{0}>0\), we have \[Z\left[x\left(n+n_{0}\right)\right] =\sum_{n=0}^{\infty n_{0}}x\left(n+n_{0}\right)\,z^{-n}\] \[=\sum_{m=n_{0}}^{\infty n_{0}}x\left(m\right)\,z^{-\left(m-n_{0} \right)}\] \[=z^{n_{0}}\left[\sum_{m=0}^{\infty}x\left(m\right)\,z^{-m}-\sum_{m =0}^{n_{0}-1}x\left(m\right)\,z^{-m}\right]\] \[=z^{n_{0}}\left[X\left(z\right)-\sum_{m=0}^{n_{0}-1}x\left(m \right)\,z^{-m}\right] \tag{8.4.14}\]

Similarly,

\[Z\left[x\left(n-n_{0}\right)\right] =\sum_{n=0}^{\infty n_{0}}x\left(n-n_{0}\right)\,z^{-n}\] \[=\sum_{m=-n_{0}}^{\infty}x\left(m\right)\,z^{-\left(m+n_{0} \right)}\] \[=z^{-n_{0}}\left[\sum_{m=0}^{\infty}x\left(m\right)\,z^{-m}+\sum _{m=-n_{0}}^{-1}x\left(m\right)\,z^{-m}\right]\] \[=z^{-n_{0}}\left[X\left(z\right)+\sum_{m=-n_{0}}^{-1}x\left(m \right)\,z^{-m}\right] \tag{8.4.15}\]

**Example 8.4.3**: Consider the difference equation

\[y\left(n\right)-\frac{1}{2}\,\,y\left(n-1\right)=\delta(n)\]

with the initial condition

\[y\left(-1\right)=3\]

In order to find \(y\left(n\right)\) for \(n\geq 0\), we use Equation (8.4.15) and take transforms on both sides of the difference equation to get

\[Y\left(z\right)-\frac{1}{2}\,\,z^{-1}\left[Y\left(z\right)+y\left(-1\right)z \right]=1\]

We now substitute the initial condition and rearrange terms so that

\[Y\left(z\right)=\frac{\frac{5}{2}}{1-\frac{1}{2}\,\,z^{-1}}=\frac{5}{2}\,\, \frac{z}{z-\frac{1}{2}}\]

It follows from Example 8.4.1(b) that

\[y\left(n\right)=\frac{5}{2}(\frac{1}{2})^{n}\,\,,\,\,\,\,\,\,\,\,\,\,\,n\geq 0\]

**Example 8.4.4**: Solve the difference equation

\[y\left(n+2\right)-y\left(n+1\right)+\frac{2}{9}\ y\left(n\right)=x\left(n\right)\]

for \(y\left(n\right),\ n\geqq 0\) if \(x\left(n\right)=u\left(n\right)\), \(y\left(1\right)=-1,\) and \(y\left(0\right)=1.\)

Using Equation (8.4.14), we have

\[z^{2}[Y(z)-y\left(0\right)-y\left(1\right)z^{-1}]-z\left[Y(z)-y\left(0\right) \right]+\frac{2}{9}\ Y\left(z\right)=X\left(z\right)\]

Substituting \(X\left(z\right)=z/\left(z-1\right)\) and using the given initial conditions, we get \(Y\left(z\right)\) as

\[(z^{2}-z+\frac{\bar{2}}{9})Y\left(z\right)=\frac{\bar{z}}{z-1}+z^{2}=z\ \frac{z^{2}-z+1}{z-1}\]

Writing \(Y\left(z\right)\) as

\[Y\left(z\right)=z\ \frac{z^{2}-z+1}{(z-1)(z-\frac{1}{3})(z-\frac{2}{3})}\]

and expanding the fractional term in partial fractions yields

\[Y\left(z\right) =z\left[\frac{\frac{9}{2}}{z-1}+\frac{\frac{7}{2}}{z-\frac{1}{3} }-\frac{7}{z-\frac{2}{3}}\right]\] \[=\frac{\frac{9}{2}\ z}{z-1}+\frac{\frac{7}{2}\ z}{z-\frac{1}{3}} -\frac{7z}{z-\frac{2}{3}}\]

From Example 8.4.1(b), it follows that

\[y\left(n\right)=\frac{9}{2}\ u\left(n\right)+\frac{7}{2}(\frac{1}{3})^{n}u \left(n\right)-7\ (\frac{2}{3})^{n}\ u\left(n\right)\]

#### Frequency Scaling

The \(Z\)-transform of sequence \(a^{n}x\left(n\right)\) is given by

\[Z\left[\ a^{n}\ x\left(n\right)\right] =\sum_{n\ =\ 0}^{\infty}a^{n}x\left(n\right)z^{-n}=\sum_{n\ =\ 0}^{\infty}x\left(n\right)(a^{-1}\ z)^{-n}\] \[=X\left(a^{-1}z\right) \tag{8.4.16}\]

**Example 8.4.5**: We can use the scaling property to derive the transform of the signal

\[y\left(n\right)=(a^{n}\ \cos\ \Omega_{0}\ n)\quad u\left(n\right)\]

from the transform of\[x(n)=\left(\cos\ \Omega_{0}\ n\right)u\left(n\right)\]

which, from Equation (8.4.6), is given by

\[X(z)=\frac{z\left(z-\cos\ \Omega_{0}\right)}{z^{2}-2z\ \cos\ \Omega_{0}+1}\]

Thus,

\[Y(z) =\frac{a^{-1}z(a^{-1}z-\cos\ \Omega_{0})}{a^{-2}z^{2}-a^{-1}z\ \cos\ \Omega_{0}+1}\] \[=\frac{z\left(z-a\ \cos\ \Omega_{0}\right)}{z^{2}-2a\ \cos\ \Omega_{0}\ z+a^{2}}\]

Similarly, the transform of

\[y(n)=a^{n}\ (\sin\ \Omega_{0}\ n)u\left(n\right)\]

can be obtained from Equation (8.4.8) as

\[Y(z)=\frac{az\ \sin\ \Omega_{0}}{z^{2}-2a\ \cos\ \Omega_{0}\ z+a^{2}}\]

#### Differentiation with Respect to \(z\)

If we differentiate both sides of Equation (8.4.1) with respect to \(z\), we obtain

\[\frac{dX(z)}{dz} =\sum_{n\ =\ 0}^{\infty}\ (-n)x\left(n\right)z^{-n-1}\] \[=-z^{-1}\ \sum_{n\ =\ 0}^{\infty}nx\left(n\right)z^{-n}\]

from which it follows that

\[Z\ [\ nx(n)]=-z\ \frac{d}{dz}\ X\left(z\right) \tag{8.4.17}\]

By successively differentiating with respect to \(z\), this result can be generalized as

\[Z\ [\ n^{k}x(n)]=(-z\ \frac{d}{dz})^{k}X\left(z\right) \tag{8.4.18}\]

We want to find the transform of the function

\[y\left(n\right)=n\left(n+1\right)u\left(n\right)\]

From Equation (8.4.17), we have

\[Z\ [\ nu\left(n\right)]=-z\ \frac{d}{dz}\ Z\left[\nu\left(n\right)\right]=-z\ \frac{d}{dz}\frac{z}{z-1}=\frac{z}{\left(z-1\right)^{2}}\]\[Z\left[\,n^{2}u\left(n\right)\right] =\left(-z\,\,\frac{d}{dz}\right)^{2}\,Z\left[u\left(n\right)\right] =-z\,\,\frac{d}{dz}\,\,\left\{-z\,\,\frac{d}{dz}\,Z\,\left[u\left(n \right)\right]\right\}\] \[=-z\,\,\frac{d}{dz}\,\,\frac{z}{\left(z-1\right)^{2}}=\frac{z\left( z+1\right)}{\left(z-1\right)^{3}}\]

so that

\[Y\left(z\right)=\frac{z\left(z+1\right)}{\left(z-1\right)^{3}}+\frac{z}{\left( z-1\right)^{2}}=\frac{2\,z^{2}}{\left(z-1\right)^{3}}\]

#### Initial Value

For a causal sequence \(x\left(n\right)\), we can write Equation (8.4.1) explicitly as

\[X\left(z\right)=x\left(0\right)+x\left(1\right)\,z^{-1}+x\left(2\right)\,z^{- 2}+\,\,\cdots\,\,+x\left(n\right)z^{-n}+\,\,\cdots \tag{8.4.19}\]

It can be seen that as \(z\rightarrow\infty\), the term \(z^{-n}\to 0\) for each \(n>0\), so that

\[\lim_{z\rightarrow\infty}\,X\left(z\right)=x\left(0\right) \tag{8.4.20}\]

#### Final Value

From the time-shift theorem, we have

\[Z\left[x\left(n\right)-x\left(n-1\right)\right]=\left(1-z^{-1}\right)\,X\left( z\right) \tag{8.4.21}\]

The left-hand side of Equation (8.4.21) can be written as

\[\sum_{n\,=\,0}^{\infty}\,\left[x\left(n\right)-x\left(n-1\right)\right]\,z^{ -n}=\lim_{N\rightarrow\infty}\,\sum_{n\,=\,0}^{N}\,\left[x\left(n\right)-x \left(n-1\right)\right]\,z^{-n}\]

If we now let \(z\to 1\), Equation (8.4.21) can be written as

\[\lim_{z\rightarrow\,1}\,\left(1-z^{-1}\right)\,X\left(z\right) =\lim_{N\rightarrow\infty}\,\sum_{n\,=\,0}^{N}\,\left[x\left(n \right)-x\left(n-1\right)\right]\] \[=\lim_{N\rightarrow\infty}\,x\left(N\right)=x\left(\infty\right) \tag{8.4.22}\]

assuming \(x\left(\infty\right)\) exists.

#### Convolution

If \(y\left(n\right)\) is the convolution of two sequences \(x\left(n\right)\) and \(h\left(n\right)\), then, in a manner analogous to our derivation of the convolution property for the discrete-time Fourier transform, we can show that

\[Y\left(z\right)=H\left(z\right)X\left(z\right) \tag{8.4.23}\]We recall that

\[Y\left(z\right)=\sum_{n\,=\,0}^{\infty}\,y\left(n\right)z^{-n}\]

so that \(y\left(n\right)\) is the coefficient of the \(n\)th term in the power-series expansion of \(Y\left(z\right)\). It follows, therefore, that when we multiply two power series or polynomials \(X\left(z\right)\) and \(H\left(z\right)\), the coefficients of the resulting polynomial are the convolutions of the coefficients in \(x\left(n\right)\) and \(h\left(n\right)\).

**Example 8.4.7**: We want to use the \(Z\)-transform to find the convolution of the following two sequences, which were considered in Example 6.3.4:

\[h\left(n\right)=\left\{1,2,0,-1,1\right\}\quad\text{ and }\quad\quad x\left(n \right)=\left\{1,3,-1,-2\right\}\]

The respective transforms are given by

\[H\left(z\right)=1+2z^{-1}-z^{-3}+z^{-4}\]

\[X\left(z\right)=1+3z^{-1}-z^{-2}-2z^{-3}\]

so that

\[Y\left(z\right)=1+5z^{-1}+5z^{-2}-5z^{-3}-6z^{-4}+4z^{-5}+z^{-6}-2z^{-7}\]

It follows that the resulting sequence is

\[y\left(n\right)=\left\{1,\,5,\,5,\,-5,\,-6,\,4,\,1,\,-2\right\}\]

This is the same answer that was obtained in Example 6.3.4.

The \(Z\)-transform properties discussed in this section are summarized in Table 8-1. Table 8-2, which is a table of \(Z\)-transform pairs of causal time functions, gives, in addition to the transforms of discrete-time sequences, the transforms of several sampled-time functions. These transforms can be obtained by fairly obvious modifications of the derivations discussed in this section and are left as exercises for the reader.

\begin{table}
\begin{tabular}{l l} \hline Sequence & Transform \\ \hline \(a_{1}x_{1}(n)+a_{2}\,x_{2}(n)\) & \(a_{1}X_{1}(z)+X_{2}(z)\) \\ \(x\left(n\,-\,n_{0}\right)\) & \(z^{-n_{0}}[X(z)+\sum\limits_{n\,=\,n_{0}}^{-1}x\left(m\right)z^{-m}]\) \\ \(x\left(n\,+\,n_{0}\right)\) & \(z^{n_{0}}[X\left(z\right)-\sum\limits_{m\,=\,0}^{n\,-1}x\left(m\right)z^{-m}]\) \\ \(a^{n}x\left(n\right)\) & \(X\left(a^{-1}z\right)\) \\ \(nx\left(n\right)\) & \(-z\dfrac{d}{dz}X(z)\) \\ \(n^{k}x\left(k\right)\) & \((-z\dfrac{d}{dz})^{k}X(z)\) \\ \(x_{1}(n)*x_{2}(n)\) & \(X_{1}(z)\,X_{2}(z)\) \\ \hline \end{tabular}
\end{table}
Table 8-1: \(Z\)-Transform Properties

\begin{table}
\begin{tabular}{c c c c} \hline  & & & Radius of \\  & & & convergence \\  & \(x\left(n\right)\) for \(n\geq 0\) & \(X\left(z\right)\) & \(\left|z\right|>R\) \\ \hline
1. & \(\delta(n)\) & 1 & 0 \\
2. & \(\delta(n-m)\) & \(z^{-m}\) & 0 \\
3. & \(u\left(n\right)\) & \(\dfrac{z}{z-1}\) & 1 \\
4. & \(n\) & \(\dfrac{z}{\left(z-1\right)^{2}}\) & 1 \\
5. & \(n^{2}\) & \(\dfrac{z\left(z+1\right)}{\left(z-1\right)^{3}}\) & 1 \\
6. & \(a^{n}\) & \(\dfrac{z}{z-a}\) & \(\left|a\right|\) \\
7. & \(na^{n}\) & \(\dfrac{az}{\left(z-a\right)^{2}}\) & \(\left|a\right|\) \\
8. & \((n+1)a^{n}\) & \(\dfrac{z^{2}}{\left(z-a\right)^{2}}\) & \(\left|a\right|\) \\
9. & \(\dfrac{(n+1)(n+2)\cdots\ (n+m)a^{n}}{m!}\) & \(\dfrac{z^{m+1}}{\left(z-a\right)^{m+1}}\) & \(\left|a\right|\) \\
10. & \(\cos\Omega_{0}\ n\) & \(\dfrac{z\left(z-\cos\Omega_{0}\right)}{z^{2}-2z\cos\Omega_{0}+1}\) & 1 \\
11. & \(\sin\Omega_{0}\ n\) & \(\dfrac{z\sin\Omega_{0}}{z^{2}-2z\cos\Omega_{0}+1}\) & 1 \\
12. & \(a^{n}\cos\Omega_{0}\ n\) & \(\dfrac{z\left(z-a\ \cos\Omega_{0}\right)}{z^{2}-2za\ \cos\Omega_{0}+a^{2}}\) & \(\left|a\right|\) \\
13. & \(a^{n}\sin\Omega_{0}\ n\) & \(\dfrac{za\ \sin\Omega_{0}}{z^{2}-2za\ \cos\Omega_{0}+a^{2}}\) & \(\left|a\right|\) \\
14. & \(\exp\left[\ -anT\right]\) & \(\dfrac{z}{z-\exp\left[\ -aT\right]}\) & \(\left|\exp\left[\ -aT\right]\right|\) \\
15. & \(nT\) & \(\dfrac{Tz}{\left(z-1\right)^{2}}\) & 1 \\
16. & \(nT\exp\left[\ -anT\right]\) & \(\dfrac{T\exp\left[\ -aT\right]}{\left[z-\exp\left[\ -aT\right]\right]^{2}}\) & \(\left|\exp\left[\ -aT\right]\right|\) \\ \hline \end{tabular}
\end{table}
Table 8-2 Table of \(Z\)-Transform Pairs

### The Inverse \(Z\)-Transform

There are several methods for finding a sequence \(x\left(n\right)\), given its \(Z\)-transform \(X\left(z\right)\). The most direct is by using the _inversion integral_:

\[x\left(n\right)=\frac{1}{2\pi j}\int_{\Gamma}X\left(z\right)\,z^{n-1}\ dz \tag{8.5.1}\]

where \(\int_{\Gamma}\) represents integration along the closed contour \(\Gamma\) in the counterclockwise direction in the \(z\) plane. The contour must be chosen to lie in the region of convergence of \(X\left(z\right)\).

Equation (8.5.1) can be derived from Equation (8.4.1) by multiplying both sides by \(z^{k-1}\) and integrating over \(\Gamma\), so that

\[\int_{\Gamma}X\left(z\right)\,z^{k-1}\ dz=\frac{1}{2\pi j}\int_{\Gamma}\sum_{n \,=\,0}^{\infty}x\left(n\right)\,z^{k-n-1}\ dz\]

By the Cauchy integral theorem,

\[\int_{\Gamma}z^{k-n-1}\ dz=\begin{cases}2\pi j,&k=n\\ 0,&k\neq n\end{cases}\]

so that

\[\int_{\Gamma}X\left(z\right)z^{k-1}\ dz=2\pi jx\left(k\right)\]

from which

\[x\left(k\right)=\frac{1}{2\pi j}\int_{\Gamma}X\left(z\right)z^{k-1}\ dz\]

and expand in partial fractions along the lines of the previous example to get

\[X\left(z\right)=z\Bigg{(}\frac{8}{z}+\frac{8}{z-\frac{1}{2}}-\frac{16}{z-\frac{1} {4}}\Bigg{)}=8+\frac{8z}{z-\frac{1}{2}}-\frac{16z}{z-\frac{1}{4}}\]

We can directly use Table 8.2 to write \(x\left(n\right)\) as

\[x\left(n\right)=8\ \delta(n)+8(\frac{1}{2})^{n}\ u\left(n\right)-16(\frac{1}{4})^{n}\ u \left(n\right)\]

To verify that this is the same solution as obtained previously, we note that for \(n=0\), we have

\[x\left(0\right)=8+8-16=0\]

For \(n\geq 1\), we get

\[x\left(n\right)=8(\frac{1}{2})^{n}-16(\frac{1}{2})^{n}=4(\frac{1}{2})^{n-1}-4 (\frac{1}{4})^{n-1}\]

Thus, either method gives the same answer.

### \(Z\)-Transfer Functions of Causal Discrete-Time Systems

We saw that given a causal system with impulse response \(h\left(n\right)\), output \(y\left(n\right)\) corresponding to any input \(x\left(n\right)\) is given by the convolution sum:

\[y\left(n\right)=\sum_{k\ =\ 0}^{\infty}\ h\left(k\right)x\left(n-k\right) \tag{8.6.1}\]

In terms of the respective \(Z\)-transforms, the output can be written as

\[Y\left(z\right)=H\left(z\right)X\left(z\right) \tag{8.6.2}\]

where

\[H\left(z\right)=Z\left[h\left(n\right)\right]=\frac{Y\left(z\right)}{X\left(z \right)} \tag{8.6.3}\]

represents the system transfer function.

If the system is described by the difference equation

\[\sum_{k\ =\ 0}^{N}\ a_{k}y\left(n-k\right)=\sum_{k\ =\ 0}^{M}\ b_{k}x\left(n-k\right) \tag{8.6.4}\]

by taking the \(Z\)-transform on both sides, and assuming zero initial conditions, we can write

\[H\left(z\right)=\frac{\sum_{k\ =\ 0}^{M}\ b_{k}z^{-k}}{\sum_{k\ =\ 0}^{N}\ a_{k}z^{-k}} \tag{8.6.5}\]It is clear that the poles of the system transfer function are the same as the characteristic values of the corresponding difference equation. From our discussion of stability in Chapter 6, it follows that for the system to be stable, the poles must lie within the unit circle in the \(z\) plane. Consequently, for a stable causal function, the ROC includes the unit circle.

**Example 8.6.1**: Consider the system shown in Figure 8.6.1 in which

\[H(z)=\frac{0.8Kz}{(z-0.8)(z-0.5)}\]

and \(K\) is a constant gain.

The transfer function of the system can be derived by noting that the output of the summer can be written as

\[E(z)=X(z)-Y(z)\]

so that the system output is

\[Y(z) =H(z)E(z)\] \[=[X(z)-Y(z)]H(z)\]

Substituting for \(H(z)\) and simplifying yields

\[Y(z)=\frac{H(z)}{1+H(z)}\ X(z)=\frac{0.8Kz}{(z-0.8)(z-0.5)+0.8\ Kz}\ X(z)\]

The transfer function for the feedback system is therefore given by

\[T(z)=\frac{Y(z)}{X(z)}=\frac{0.8Kz}{z^{2}+(0.8\ K-1.3)z+0.04}\]

The poles of the system can be determined as the roots of the equation

\[z^{2}+(0.8K-1.3)z+0.04=0\]

For \(K=1\), the two roots are at

\[z_{1}=0.1\quad\text{ and }\qquad z_{2}=0.4\]

Since both roots are inside the unit circle, the system is stable. With \(K=4\), however, the roots are given by

\[z_{1}=0.0213\quad\text{ and }\qquad z_{2}=1.87875\]

Since one of the roots is now outside the unit circle, the system is unstable.

Figure 8.6.1: Block diagram of control system of Example 8.6.1.

### 8.7 \(Z\)-Transform Analysis of State-Variable Systems

As we have seen in our discussions, the use of frequency-domain techniques considerably simplifies the analysis of linear time-invariant systems. In this section, we consider the \(Z\)-transform analysis of discrete-time systems that are represented by a set of state equations of the form

\[\mathbf{v}(n+1)=\mathbf{Av}(n)+\mathbf{b}x\left(n\right),\ \ \ \ \mathbf{v}(0)= \mathbf{v}_{0} \tag{8.7.1}\]

\[y\left(n\right)=\mathbf{cv}(n)+dx\left(n\right)\]

As we will see, the use of \(Z\)-transforms is useful both in deriving state-variable representations from the transfer function of the system and in obtaining the solution to the state equations.

In Chapter 6, starting from the difference-equation representation, we derived two alternate state-space representations. Here, we start with the transfer-function representation and derive two more representations, namely, the parallel and cascade forms. In order to show how this can be done, let us consider a simple first-order system described by the state-variable equation:

\[v\left(n+1\right)=av\left(n\right)+bx\left(n\right) \tag{8.7.2}\]

\[y\left(n\right)=cv\left(n\right)+dx\left(n\right)\]

From Equation (8.7.2), it follows that

\[V\left(z\right)=\frac{b}{z-a}X\left(z\right)\]

Thus, the system can represented by the block diagram of Figure 8.7.1. Note that as far as the relation between \(Y\left(z\right)\) and \(X\left(z\right)\) is concerned, gains \(b\) and \(c\) at the input and output can be arbitrary as long as their product is equal to \(bc\).

Figure 8.7.1: Block diagram of a first-order state-space system.

\[(z+\frac{1}{2})V_{2}(z)=X(z)\]

\[Y(z)=V_{1}(z)\]

which in the time domain are equivalent to

\[v_{1}(n+1)=\frac{1}{4}\ v_{1}(n)+x_{1}(n)\]

\[x_{1}(n)=3v_{2}(n+1)+\frac{3}{4}\ v_{2}(n)\]

\[v_{2}(n+1)=-\ \frac{\frac{1}{2}}{v_{2}(n)+x(n)}\]

\[y(n)=v_{1}(n)\]

Eliminating \(x_{1}(n)\) and rearranging the equations yields

\[v_{1}(n+1)=\frac{1}{4}\ v_{1}(n)-\frac{3}{4}\ v_{2}(n)+3x(n)\]

\[v_{2}(n+1)=-\ \frac{1}{2}\ v_{2}(n)+x(n)\]

\[y(n)=v_{1}(n)\]

To get the second canonical form, we use the block diagram of Figure 8.7.2(c) to get

Figure 8.7.2: Block-diagram representations for Example 8.7.1.

\[H_{1}(z)=\frac{1+0.5z^{-1}}{1+0.5z^{-1}+0.8z^{-2}}\qquad H_{2}(z)=\frac{1+2z^{-1}}{ 1+0.3z^{-1}}\]

we can draw the simulation diagram using Figure 8.7.3 as shown in Figure 8.7.4.

Using the outputs of the delays as state variables, we get the following equations:

\[\hat{\hat{V}}(z) =zV_{1}(z)=-0.3V_{1}(z)+X_{1}(z)\] \[X_{1}(z) =V(z)+0.5V_{2}(z)\] \[zV_{2}(z) =V(z)=-0.5V_{2}(z)-0.8V_{3}(z)+X(z)\] \[zV_{3}(z) =V_{2}(z)\] \[Y(z) =\hat{\hat{V}}(z)+2V_{1}(z)\]

Eliminating \(V(z)\) and \(\hat{V}(z)\) and writing the equivalent time-domain equations yields

\[v_{1}(n+1) =-0.3v_{1}(n)-0.8v_{3}(n)+x(n)\] \[v_{2}(n+1) =-0.5v_{2}(n)-0.8v_{3}(n)+x(n)\] \[v_{3}(n+1) =v_{2}(n)\] \[y(n) =1.7\ v_{1}(n+1)-0.8v_{3}(n)+x(n)\]

Clearly, by using different combinations of first- and second-order sections, we can obtain several different realizations of a given transfer function.

Figure 8.7.3: Simulation diagram for a second order discrete time system.

#### Frequency-Domain Solution of the State Equations

We now consider the frequency-domain solution of the state equations of Equation (8.7.1), which we repeat for convenience.

\[\mathbf{v}(n+1)=\mathbf{A}\mathbf{v}(n)+\mathbf{b}x\left(n\right); \quad\mathbf{v}(0)=\mathbf{v}_{0} \tag{8.7.5a}\] \[y\left(n\right)=\mathbf{c}\mathbf{v}(n)+dx\left(n\right) \tag{8.7.5b}\]

\(Z\)-transforming both sides of Equation (8.7.5a) yields

\[z\left[\mathbf{V}(z)-\mathbf{v}_{0}\right]=\mathbf{A}\mathbf{V}(z)+\mathbf{b} X\left(z\right) \tag{8.7.6}\]

Solving for \(\mathbf{V}(z)\), we get

\[\mathbf{V}(z)=z\left(z\mathrm{I}-\mathbf{A}\right)^{-1}\ \mathbf{v}_{0}+\left(z \mathrm{I}-\mathbf{A}\right)^{-1}\ \mathbf{b}X\left(z\right) \tag{8.7.7}\]

It follows from Equation (8.7.5b) that

\[Y\left(z\right)=\mathbf{c}z\left(z\mathrm{I}-\mathbf{A}\right)^{-1}\ \mathbf{v}_{0}+\mathbf{c}(z\mathrm{I}-\mathbf{A})^{-1}\ \mathbf{b}X\left(z\right)+dX\left(z\right) \tag{8.7.8}\]

We can determine the transfer function of this system by setting \(\mathbf{v}(0)=0\) to get

\[Y\left(z\right)=\left[\mathbf{c}(z\mathrm{I}-\mathbf{A})^{-1}\mathbf{b}+d\, \right]X\left(z\right) \tag{8.7.9}\]

It follows that

\[H\left(z\right)=\frac{Y\left(z\right)}{X\left(z\right)}=\mathbf{c}(z\mathrm{I }-\mathbf{A})^{-1}\ \mathbf{b}+d \tag{8.7.10}\]

Figure 8.7.4: Simulation diagram for Example 8.7.2.

which is the same result that was obtained in Example 6.7.2. From Equation (8.7.7), for the given initial condition, we have

Multiplying terms and expanding in partial fractions yields

so that

To find the output, we note that

and

These are exactly the same as the results in Example 6.7.3. Finally, we have from Equation (8.7.10)

so that

Since, we can write the last equation equivalently as \[h(n)=\frac{4}{3}\ (\frac{1}{4})^{n}-\frac{4}{3}\ (-\ \frac{1}{2})^{n},\qquad n\geq 0\]

which is the result obtained in Example 6.7.4.

### Relation between the \(Z\)-transform

and the Laplace transform

\[x_{s}(t)=\sum_{n\ =\ -\infty}^{\infty}x_{a}(nT)\ \delta(t-nT) \tag{8.8.1}\]

and

\[x\left(n\right)=x_{a}(nT) \tag{8.8.2}\]

The Laplace transformation of Equation (8.8.1) yields

\[X_{s}(s)=\sum_{n\ =\ -\infty}^{\infty}x_{a}(nT)\ \exp\left[-nTs\right] \tag{8.8.3}\]

If we make the substitution \(z=\exp\left[Ts\right]\) then

\[X_{s}(s)\ \Big{|}\ _{z\ =\ \exp\left[Ts\right]}=\sum_{n\ =\ -\infty}^{\infty}x_{a}(nT)z^{-n} \tag{8.8.4}\]

We recognize that the right-hand side of Equation (8.8.4) is the \(Z\)-transform, \(X\left(z\right)\), of sequence \(x\left(n\right)\). Thus, the \(Z\)-transform can be viewed as the Laplace transform of sampled function \(x_{s}(t)\) with the change of variable

\[z=\exp\left[Ts\right] \tag{8.8.5}\]

Equation (8.8.5) defines a mapping of the \(s\) plane to the \(z\) plane. To determine the nature of this mapping, let \(s=\sigma+j\omega\), so that

\[z=\exp\left[\,\sigma T\,\right]\exp\left[\,j\omega T\,\right]\]

Since \(\ |\ z\ |\ =\exp\left[\,\sigma T\,\right]\), it is clear that if \(\sigma<0,\ |\ z\ |\ <1\). Thus, any point in the left half of the \(s\) plane is mapped into a point inside the unit circle in the \(z\) plane. Similarly, since for \(\sigma>0\), we have \(\ |\ z\ |\ >1\), a point in the right half of the \(s\) plane is mapped into a point outside the unit circle in the \(z\) plane. For \(\sigma=0,\ |\ z\ |\ =1\), so that the \(j\omega\)-axis of the \(s\) plane is mapped into the unit circle in the \(z\) plane. The origin in the \(s\) plane corresponds to the point \(z=1\).

Finally, let \(s_{k}\) denote a set of points that are spaced vertically apart from any point \(s^{*}\) by multiples of sampling frequency \(\omega_{s}=2\pi/T\). That is,\[s_{k}=s^{{}^{+}}+jk\omega_{s},\qquad k=0,\,\pm 1,\,\pm 2,\,\ldots\]

Then we have

\[z_{k}=\exp\left[\,Ts_{k}\right]=s^{T\left(s^{{}^{+}}+jk\omega_{s}\right)}=\exp \left[\,Ts^{{}^{+}}\right]=z^{{}^{*}}\]

since \(\exp\left[\,jk\omega_{s}T\right]=\exp\left[\,j\,2k\pi\right]\). That is, points \(s_{k}\) all map into the same point \(z^{{}^{*}}=\exp\left[\,Ts^{{}^{*}}\right]\) in the \(z\) plane. We can thus divide the \(s\)-plane into horizontal strips, each of width \(\omega_{s}\). Each of these strips is then mapped onto the entire \(z\)-plane. For convenience, we choose these strips to be symmetric about the horizontal axis. This is summarized in Figure 8.8.1, which shows the mapping of the \(s\)-plane into the \(z\)-plane.

We have already seen that \(X_{s}(\omega)\) is periodic with period \(\omega_{s}\). Equivalently, \(X\left(\Omega\right)\) is periodic with period \(2\pi\). This is easily seen to be a consequence of the result that the process of sampling essentially divides the \(s\)-plane into a set of horizontal strips of width \(\omega_{s}\), which are identical. The fact that the mapping from this plane to the \(z\)-plane is not unique (the same point in the \(z\)-plane corresponds to several points in the \(s\)-plane) is a consequence of the fact that we can associate any one of several analog signals with a given set of sample values.

### Summary

* The \(Z\)-transform is the discrete-time counterpart of the Laplace transform.
* The bilateral \(Z\)-transform of discrete-time sequence \(x\left(n\right)\) is defined as \[X\left(z\right)=\sum_{n\,=\,-\,\infty}^{\infty}x\left(n\right)z^{-n}\]
* The unilateral \(Z\)-transform of causal signal \(x\left(n\right)\) is defined as

Figure 8.8.1: Mapping of the \(s\)-plane onto the \(z\)-plane by the transformation \(z=\exp\left[\,Ts\right]\).